# What files to copy or adapt for each task?
## 1. Create MQTT Inspector

- `modbus.cc`: `class Modbus : public Inspector`, `Modbus::eval(Packet*)`, `Modbus::get_buf(...)`, `Modbus::get_splitter(bool)`
- `modbus.h`: `struct ModbusFlowData`
- `inspector.h`: `class snort::Inspector` interface (inherit + overrides)


## 2. Register Inspectors

- `modbus.cc`: `modbus_init()`, `modbus_ctor(...)`, `modbus_dtor(...)`, `InspectApi` (`PT_INSPECTOR`), `sin_modbus[]` (`#ifdef BUILDING_SO`)
- `service_inspectors.cc`: `load_service_inspectors()`
- top-level `CMakeLists.txt`: add mqtt subdir
- mqtt `CMakeLists.txt`: module/library build template
- `modbus_module.h`: `class ModbusModule : public snort::Module`
- `modbus_module.cc`


## 3. Parse Publish Messages

- `modbus_decode.cc`: `ModbusDecode(...)`
- `modbus_decode.h`
- `modbus_paf.h`: `class ModbusSplitter : public StreamSplitter`
- `modbus_paf.cc`
- `dns.cc`

## 4. Publish Topic/Events

- `data_bus.h`: `class DataEvent`, `DataBus::publish(...)`
- `pub_sub/dns_events.h`
- `pub_sub/http_events.h`
- `dns_payload_event_handler.cc`
- `pub_sub/mqtt_events.h`
- `modbus.cc`

- `ips_modbus_data.cc`: IPS option implementation pattern

**Core glue**
- `base_api.h`: `BaseApi`
- `module.h`: `snort::Module`
- `dev_notes.txt`